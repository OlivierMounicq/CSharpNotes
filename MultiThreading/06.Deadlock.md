#Deadlock


###How to create a deadlock ?

It's simple!

```cs

void CreateDeadlock()
{
  var ressource1 = new Object();
  var ressource2 = new Object();
  
  var Thread1 = new Thread(delegate() { Work( Ressource1, Ressource2) };
  var Thread2 = new Thread(delegate() { Work( Ressource2, Ressource1) };

  T1.Start();
  T2.Start();
}


void Work(Object acquire, Object demand)
{
  lock(aquire)
  {
    Thread.Sleep(1000) //to ensure that you will get a nice deadlock!
    lock(demand)
    {
      //the code will never use!
    }
  }
}

```

###How to prevent the deadlock ?

#### First method : use a timeout
Instead to use the keyword _lock_ (which is an alias), you should use directly _Monitor_ object.  
So, we can use this code to avoid the deadlock:

```cs
if(Monitor.TryEnter(ressource, 10000))
{
  try
  {
  
  }
  finally
  {
    Monitor.Exit();
  }


}
else
{
  //Raise an information about the deadlock
}
```


